---
title: "Problem set"
author: "Xinyi Lin"
date: "9/25/2019"
output: word_document
---

## Problem 1

### Question a

To calculate a sample size, we need additional information including:

1) The dependent variable is approximately normally distributed within each group.

2) The data is collected from a representative, randomly selected portion of the total population.

### Question b

If we assume sample size of two groups are the same. As $t = \frac{d}{var\times\sqrt{\frac{2}{n}}}$
In order to have 5% significance, $t>t_{1-\frac{2}{\alpha},2n-2}$

## Problem 1

### Question a

```{r}
14*pbinom(0, 14, 0.05) + 20*(1-pbinom(0, 14, 0.05))
```

The expected value of the sample size is around 17.07.

### Question b

Let $R_i$ be the number of responses in the first or second stages, where $i \in\{1,2\}$.

The probability of a "go" decision is
$$\begin{split}
P_b&=\sum_{j=1}^4[P(R_1+R_2\geq4)]+P(R_1>4) \\
&=\sum_{j=1}^4[P(R_2>3-j,R_1=j)]+P(R_1>4) \\
&=\sum_{j=1}^4[P(R_2>3-j)P(R_1=j)]+P(R_1>4)
\end{split}$$.

```{r}
pbinom(3, 20, 0.05, lower.tail = FALSE)*dbinom(0, 14, 0.05) + pbinom(2, 20, 0.05, lower.tail = FALSE)*dbinom(1, 14, 0.05) + pbinom(1, 20, 0.05, lower.tail = FALSE)*dbinom(2, 14, 0.05) + pbinom(0, 20, 0.05, lower.tail = FALSE)*dbinom(3, 14, 0.05) + pbinom(4, 14, 0.05, lower.tail = FALSE)
```

So the probability of a "go" decision is around 0.084.

### Question c

```{r}
pbinom(3, 20, 0.2, lower.tail = FALSE)*dbinom(0, 14, 0.2) + pbinom(2, 20, 0.2, lower.tail = FALSE)*dbinom(1, 14, 0.2) + pbinom(1, 20, 0.2, lower.tail = FALSE)*dbinom(2, 14, 0.2) + pbinom(0, 20, 0.2, lower.tail = FALSE)*dbinom(3, 14, 0.2) + pbinom(4, 14, 0.2, lower.tail = FALSE)
```

When teh true response rate is 20%, the probability of a "go" decision is around 0.758.

### Question d

Let $n$ be the sample size of the fixed design, $R$ be the number of response in the trial, if there is at least $x$ response, then the treatment is deemed promising ("go")

$$type \ I \ error = P(reject \ null|null \ is \ true) = P(R>X|p=0.05)$$
$$power = P(reject \ null|alternative \ is \ true) = P(R>X|p=0.2)$$

```{r}
n = 3
x = 1
while(pbinom(x-1,n,0.05)>0.084 | pbinom(x-1,n,0.2)<0.758){
  if(x<n-1){
    x = x+1
  } else {
    x = 1
    n = n+1}
}
```

